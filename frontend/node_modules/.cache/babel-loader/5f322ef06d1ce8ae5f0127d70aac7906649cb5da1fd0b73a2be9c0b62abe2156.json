{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\joelg\\\\Downloads\\\\MernStack-Tour-Management-main\\\\MernStack-Tour-Management-main\\\\tour-management\\\\frontend\\\\src\\\\router\\\\ProtectedRoute.js\",\n  _s = $RefreshSig$();\nimport React, { useContext, useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { AuthContext } from '../context/AuthContext';\nimport Dashboard from '../admin/Dashboard';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProtectedRoute = () => {\n  _s();\n  const {\n    user\n  } = useContext(AuthContext);\n  const navigate = useNavigate();\n  const [userData, setUserData] = useState(null);\n  useEffect(() => {\n    // Fetch user data from the backend when the component mounts\n    if (user) {\n      fetchUserData(user.id); // Assuming you have a user ID\n    }\n  }, [user]);\n  const fetchUserData = async userId => {\n    try {\n      // Make a fetch request to your backend to get user data\n      const response = await fetch(`http://localhost:4000/api/v1/users/`); // Adjust the API endpoint as needed\n      if (response.ok) {\n        const data = await response.json();\n        setUserData(data);\n      } else {\n        // Handle error, e.g., redirect to home or show an error message\n        navigate('/'); // Redirect to the home page if the fetch fails\n      }\n    } catch (error) {\n      console.error('Error fetching user data:', error);\n    }\n  };\n  if (!user) {\n    navigate('/login'); // Redirect unauthenticated users to the login page\n    return null;\n  }\n  if (userData && userData.role === 'admin') {\n    return /*#__PURE__*/_jsxDEV(Dashboard, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 12\n    }, this);\n  }\n  navigate('/dashboard'); // For non-admin users, redirect to the home page\n  return null;\n};\n_s(ProtectedRoute, \"n6e2CGm0v5ZreO2SmP6H4THxdFA=\", false, function () {\n  return [useNavigate];\n});\n_c = ProtectedRoute;\nexport default ProtectedRoute;\nvar _c;\n$RefreshReg$(_c, \"ProtectedRoute\");","map":{"version":3,"names":["React","useContext","useEffect","useState","useNavigate","AuthContext","Dashboard","ProtectedRoute","user","navigate","userData","setUserData","fetchUserData","id","userId","response","fetch","ok","data","json","error","console","role"],"sources":["C:/Users/joelg/Downloads/MernStack-Tour-Management-main/MernStack-Tour-Management-main/tour-management/frontend/src/router/ProtectedRoute.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport Dashboard from '../admin/Dashboard';\r\n\r\nconst ProtectedRoute = () => {\r\n  const { user } = useContext(AuthContext);\r\n  const navigate = useNavigate();\r\n  const [userData, setUserData] = useState(null);\r\n\r\n  useEffect(() => {\r\n    // Fetch user data from the backend when the component mounts\r\n    if (user) {\r\n      fetchUserData(user.id); // Assuming you have a user ID\r\n    }\r\n  }, [user]);\r\n\r\n  const fetchUserData = async (userId) => {\r\n    try {\r\n      // Make a fetch request to your backend to get user data\r\n      const response = await fetch(`http://localhost:4000/api/v1/users/`); // Adjust the API endpoint as needed\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setUserData(data);\r\n      } else {\r\n        // Handle error, e.g., redirect to home or show an error message\r\n        navigate('/'); // Redirect to the home page if the fetch fails\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching user data:', error);\r\n    }\r\n  };\r\n\r\n \r\n  if (!user) {\r\n    navigate('/login'); // Redirect unauthenticated users to the login page\r\n    return null;\r\n  }\r\n\r\n  if (userData && userData.role === 'admin') {\r\n    return <Dashboard />;\r\n  }\r\n\r\n  navigate('/dashboard'); // For non-admin users, redirect to the home page\r\n  return null;\r\n};\r\nexport default ProtectedRoute;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,UAAU,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC9D,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,WAAW,QAAQ,wBAAwB;AACpD,OAAOC,SAAS,MAAM,oBAAoB;AAAC;AAE3C,MAAMC,cAAc,GAAG,MAAM;EAAA;EAC3B,MAAM;IAAEC;EAAK,CAAC,GAAGP,UAAU,CAACI,WAAW,CAAC;EACxC,MAAMI,QAAQ,GAAGL,WAAW,EAAE;EAC9B,MAAM,CAACM,QAAQ,EAAEC,WAAW,CAAC,GAAGR,QAAQ,CAAC,IAAI,CAAC;EAE9CD,SAAS,CAAC,MAAM;IACd;IACA,IAAIM,IAAI,EAAE;MACRI,aAAa,CAACJ,IAAI,CAACK,EAAE,CAAC,CAAC,CAAC;IAC1B;EACF,CAAC,EAAE,CAACL,IAAI,CAAC,CAAC;EAEV,MAAMI,aAAa,GAAG,MAAOE,MAAM,IAAK;IACtC,IAAI;MACF;MACA,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAE,qCAAoC,CAAC,CAAC,CAAC;MACrE,IAAID,QAAQ,CAACE,EAAE,EAAE;QACf,MAAMC,IAAI,GAAG,MAAMH,QAAQ,CAACI,IAAI,EAAE;QAClCR,WAAW,CAACO,IAAI,CAAC;MACnB,CAAC,MAAM;QACL;QACAT,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC;MACjB;IACF,CAAC,CAAC,OAAOW,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;IACnD;EACF,CAAC;EAGD,IAAI,CAACZ,IAAI,EAAE;IACTC,QAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC;IACpB,OAAO,IAAI;EACb;EAEA,IAAIC,QAAQ,IAAIA,QAAQ,CAACY,IAAI,KAAK,OAAO,EAAE;IACzC,oBAAO,QAAC,SAAS;MAAA;MAAA;MAAA;IAAA,QAAG;EACtB;EAEAb,QAAQ,CAAC,YAAY,CAAC,CAAC,CAAC;EACxB,OAAO,IAAI;AACb,CAAC;AAAC,GAxCIF,cAAc;EAAA,QAEDH,WAAW;AAAA;AAAA,KAFxBG,cAAc;AAyCpB,eAAeA,cAAc;AAAC;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}